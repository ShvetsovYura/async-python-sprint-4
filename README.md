### Реализован кастомное взаимодействие с БД
Не добавлена работа со сложными типами БД: массивы любых типов, временные интервалы, json/jsonb
Не реализован пул подключений
Не реализовано подключение по SSL/TLS, Kerberos  и прочим оверхед вещам

Реализовано асинхронное взаимодейтсвие, CRUD, транзакции, передача параметров в запрос (по плейсхолдерам), результат в виде списка словарей
Чуть не хватает обработки ошибок :)


### Развертывание:

Необходимо выпполнить команду `docker-compose up -d`

Поднимутся следующие контейнеры:
- pg_cnt - контенер с Postgres 13 (данные будут примонтированы с локальной машины и при пересоздания контенера данные сохранятся)
- pgadmin_cnt - контейнер с интсрументом управленя БД (pgadmin) доступен по http://localhost:8088
- link_cutter_cnt - контейнер с срвисом коротких ссылок, доступер по http://localhost:8080

Зайти на http://localhost:8088:
- ввести логин и пароль для pgadmin (смотри переменные окружения)
- добавить сервер БД (в роли хоста надо ввести `postgres`, остальное - из переменных окружения)
- скопировать содержимое из `scr/init_db_schema.sql` и выполнить для БД `cutter_db`

Проверить коннект к сервису коротких ссылок:
- http://localhost:8080/api/v1/healt - жив ли сам сервис
- http://localhost:8080/api/v1/ping - есть ли коннект к БД


### Http сервис на FastAPI

Требования: 
- python >=3.9
- postgres >= 13 (на остальных не тестировалось)

### Разворачивание локально
Убедиться, что Posgres увтановлен

выполнить к БД sql-скрипт `init_db_schema.sql`

Склонировать проект и установить зависимости

    $ python3 -m pip install -r requirements.dev.txt

Перейти в директорию с проектом и выполнить

    $ python3 src/main.py

Поднимиется сервис согласно выставленому порту в app-config.yml


Для разработки потребуестя устновить `pre-commit`

    $ pip3 install --user pre-commit

И в проекте выполнить:

    $ pre-commit install

<details>
<summary> Проектное задание четвертого спринта </summary>

# Проектное задание четвертого спринта

Спроектируйте и реализуйте сервис для создания сокращенной формы передаваемых URL и анализа активности их использования.

Кроме этого, выберите из списка дополнительные требования и тоже реализуйте их. У каждого задания есть определённая сложность, от которой зависит количество баллов. Вам необходимо выбрать такое количество заданий, чтобы общая сумма баллов была больше 4. Выбор заданий никак не ограничен: можно выбрать все простые или одно среднее и два простых, или одно продвинутое, или решить все.

## Описание задания

Реализовать **http**-сервис, который обрабатывает поступающие запросы. Сервер стартует по адресу `http://127.0.0.1:8080`.


<details>
<summary> Список необходимых эндпойнтов (можно изменять) </summary>

1. Получить сокращенный вариант переданного URL
```python
POST /
```

Request
```json
https://...
```

Метод принимает в теле запроса строку URL для сокращения и возвращает ответ с кодом `201`.


2. Вернуть оригинальный URL
```python
GET /<url_id>
```
Метод принимает в качестве параметра идентификатор сокращенного URL и возвращает ответ с кодом `307` и оригинальным URL в заголовке `Location`.

3. Вернуть статус использования URL
```python
GET /<url_id>/status?[full-info]&&[max-result=10]&&[offset=0]
```
Метод принимает в качестве параметра идентификатор сокращенного URL и возвращает информацию о количестве переходов, совершенных по ссылке.

В ответе может содержаться как общее количество совершенных переходов, так и дополнительная детализированная информация о каждом переходе (наличие **query**-параметра **full-info** и параметров пагинации):
- время перехода/использования ссылки;
- информация о клиенте, выполнившем запрос;

</details>



### Дополнительные требования (отметить [Х] выбранные пункты):

- [x] (1 балл) Реализуйте метод `GET /ping`, который возвращает информацию о статусе доступности БД.
- [x] (1 балл) Реализуйте возможность "удаления" сохраненного URL. Запись должна оставаться, но помечаться как удаленная. При попытке получения полного URL возвращать ответ с кодом `410 Gone`.

- [x] (2 балла) Реализуйте **middlware**, блокирующий доступ к сервису запросов из запрещенных подсетей (black list).
- [ ] (2 балла) Реализуйте возможность передавать ссылки пачками (batch upload).

<details>
<summary> Описание изменений </summary>

- Метод `POST /shorten` принимает в теле запроса список URL в формате:
```python
[
    {
        "original_url": "URL for shorten"
    },
    ...
]

```
и возвращает данные в формате:
```python
[
    {
        "url_id": "<text-id>",
        "short_url": "https://...",
    },
    ...
]
```
</details>



- [ ] (3 балла) Реализуйте взаимодействие с сервисом авторизованного пользователя. Пользователь может создавать как приватные, так и публичные ссылки или изменять видимость ссылок. Вызов метода `GET /user/status` возвращает все созданные ранее ссылки в формате:

```
[
    {
        "short_id": "<text-id>",
        "short_url": "https://...",
        "original_url": "https://...",
        "type": "<public|private>"
    },
    ...
]
```

- [x] **(5 баллов) Реализовать кастомную реализацию взаимодействия с БД. Учесть возможность работы с транзакциями.


## Требования к решению

1. Используйте фреймворк FastAPI. В качестве СУБД используйте PostgreSQL (не ниже 10).
2. Используйте концепции ООП.
3. Предусмотрите обработку исключительных ситуаций. 
4. Приведите стиль кода в соответствие pep8, flake8, mypy. 
5. Логируйте результаты действий. 
6. Покройте написанный код тестами. 
</detail>